"use strict";(self.webpackChunkvolca_docs=self.webpackChunkvolca_docs||[]).push([[194],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>m});var o=n(7294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,o,i=function(e,t){if(null==e)return{};var n,o,i={},r=Object.keys(e);for(o=0;o<r.length;o++)n=r[o],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(o=0;o<r.length;o++)n=r[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var u=o.createContext({}),c=function(e){var t=o.useContext(u),n=t;return e&&(n="function"==typeof e?e(t):a(a({},t),e)),n},p=function(e){var t=c(e.components);return o.createElement(u.Provider,{value:t},e.children)},s="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},g=o.forwardRef((function(e,t){var n=e.components,i=e.mdxType,r=e.originalType,u=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),s=c(n),g=i,m=s["".concat(u,".").concat(g)]||s[g]||d[g]||r;return n?o.createElement(m,a(a({ref:t},p),{},{components:n})):o.createElement(m,a({ref:t},p))}));function m(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var r=n.length,a=new Array(r);a[0]=g;var l={};for(var u in t)hasOwnProperty.call(t,u)&&(l[u]=t[u]);l.originalType=e,l[s]="string"==typeof e?e:i,a[1]=l;for(var c=2;c<r;c++)a[c]=n[c];return o.createElement.apply(null,a)}return o.createElement.apply(null,n)}g.displayName="MDXCreateElement"},6560:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>u,contentTitle:()=>a,default:()=>s,frontMatter:()=>r,metadata:()=>l,toc:()=>c});var o=n(7462),i=(n(7294),n(3905));const r={slug:"/configure-authentication"},a="5. Configure authentication",l={unversionedId:"project-setup/setup-authentication",id:"project-setup/setup-authentication",title:"5. Configure authentication",description:"When you first setup Volca it will run with a mock user and without authentication. This is beneficial to quickly get up and running locally, but when you keep developing your project you need to setup the proper authentication solution.",source:"@site/docs/project-setup/05-setup-authentication.md",sourceDirName:"project-setup",slug:"/configure-authentication",permalink:"/docs/configure-authentication",draft:!1,tags:[],version:"current",sidebarPosition:5,frontMatter:{slug:"/configure-authentication"},sidebar:"tutorialSidebar",previous:{title:"4. Deploy to AWS",permalink:"/docs/deploy-to-aws"},next:{title:"6. Configure Stripe",permalink:"/docs/configure-stripe"}},u={},c=[{value:"Setting up identity providers",id:"setting-up-identity-providers",level:3},{value:"Using AWS Cognito for local development",id:"using-aws-cognito-for-local-development",level:2}],p={toc:c};function s(e){let{components:t,...n}=e;return(0,i.kt)("wrapper",(0,o.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"5-configure-authentication"},"5. Configure authentication"),(0,i.kt)("p",null,"When you first setup Volca it will run with a mock user and without authentication. This is beneficial to quickly get up and running locally, but when you keep developing your project you need to setup the proper authentication solution."),(0,i.kt)("h3",{id:"setting-up-identity-providers"},"Setting up identity providers"),(0,i.kt)("p",null,"Volca currently supports the following login methods:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Facebook"),(0,i.kt)("li",{parentName:"ul"},"Google"),(0,i.kt)("li",{parentName:"ul"},"Apple"),(0,i.kt)("li",{parentName:"ul"},"Email / Password")),(0,i.kt)("p",null,"By default email/password will always be enabled, but you can select what social login providers you want to use, if any."),(0,i.kt)("p",null,"To configure your login providers, you can add information about them in your app config file. Here is an example of how this might look for your staging environment. To get the client-ids and secrets you will need to set them up at Facebook, Google and Apple. We recommend you to ",(0,i.kt)("a",{parentName:"p",href:"https://docs.aws.amazon.com/cognito/latest/developerguide/external-identity-providers.html"},"follow this guide from AWS"),"."),(0,i.kt)("p",null,"For staging, we also add the config ",(0,i.kt)("inlineCode",{parentName:"p"},"allowLocalhost: true")," to allow localhost as an allowed domain to sign in from. This is not recommended for your production environment."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},"staging: {\n    ...,\n    authentication: {\n      identityProviders: {\n        google: {\n          clientId: 'client-id',\n          clientSecretSsmPath: '/my-app/staging/AWS_COGNITO_GOOGLE_CLIENT_SECRET',\n        },\n        facebook: {\n          clientId: 'client-id',\n          clientSecretSsmPath: '/my-app/staging/AWS_COGNITO_FACEBOOK_CLIENT_SECRET',\n        },\n        apple: {\n          clientId: 'client-id',\n          teamId: 'team-id',\n          keyId: 'key-id',\n          privateKeySsmPath: '/my-app/staging/AWS_COGNITO_APPLE_PRIVATE_KEY',\n        },\n      },\n      allowLocalhost: true,\n    },\n    ...\n}\n")),(0,i.kt)("p",null,"Once the config has been added, you can deploy your infrastructure to AWS as described in the previous section."),(0,i.kt)("h2",{id:"using-aws-cognito-for-local-development"},"Using AWS Cognito for local development"),(0,i.kt)("p",null,"Once your infrastructure has been deployed to staging, we can leverage those resources for our local development. You can do this by adding the following config to the local block in ",(0,i.kt)("inlineCode",{parentName:"p"},"app.config.ts"),"."),(0,i.kt)("p",null,"Here we add empty objects as the value for the identity providers we use to enable them and we also add the login domain we want to use. In the example we specify the login domain of our staging environment as the one we want to use to sign in."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},"    authentication: {\n      identityProviders: {\n        google: {},\n        facebook: {},\n        apple: {},\n      },\n      loginDomain: 'login.staging.my-app.com', // Replace my-app with your application name\n    },\n")))}s.isMDXComponent=!0}}]);